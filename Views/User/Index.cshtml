@using ShareForceOne;

@{
    ViewData["Title"] = "Index";
}
<div>
        <div class="container">
            <div class="row">
                <div class="col-md-6 align-self-center" style="padding: 8px;"><a class="btn btn-primary btn-block border rounded" role="button" asp-area="" asp-controller="Trip" asp-action="TripCreate">Create</a></div>
                <div class="col-md-6" style="padding: 8px;"><button class="btn btn-primary btn-block border rounded" type="button">Button</button></div>
            </div>
        </div>
    </div>
    @*<div class="container" id="floating-panel">
        <div class="row">
            <div class="col-md-4 align-self-center" style="padding: 8px;">
                <button class="btn btn-primary btn-block border rounded" type="button" onclick="clearMarkers();">Hide Marker</button>
            </div>
            <div class="col-md-4 align-self-center" style="padding: 8px;">
                <button class="btn btn-primary btn-block border rounded" type="button" onclick="showMarkers();">Show Marker</button>
            </div>
            <div class="col-md-4 align-self-center" style="padding: 8px;">
                <button class="btn btn-primary btn-block border rounded" type="button" onclick="deleteMarkers();">Delete Marker</button>
            </div>
        </div>
    </div>*@

@*//MAP*@

<div id="floating-panel">
    <b>Start: </b>
    <select id="start">
        <option value="sundsvall">sundsvall</option>
        <option value="st louis, mo">St Louis</option>
        <option value="joplin, mo">Joplin, MO</option>
        <option value="oklahoma city, ok">Oklahoma City</option>
        <option value="amarillo, tx">Amarillo</option>
        <option value="gallup, nm">Gallup, NM</option>
        <option value="flagstaff, az">Flagstaff, AZ</option>
        <option value="winona, az">Winona</option>
        <option value="kingman, az">Kingman</option>
        <option value="barstow, ca">Barstow</option>
        <option value="san bernardino, ca">San Bernardino</option>
        <option value="los angeles, ca">Los Angeles</option>
    </select>
    <b>End: </b>
    <select id="end">
        <option value="stockholm">stockholm</option>
        <option value="stockholm">stockholm</option>
        <option value="joplin, mo">Joplin, MO</option>
        <option value="oklahoma city, ok">Oklahoma City</option>
        <option value="amarillo, tx">Amarillo</option>
        <option value="gallup, nm">Gallup, NM</option>
        <option value="flagstaff, az">Flagstaff, AZ</option>
        <option value="winona, az">Winona</option>
        <option value="kingman, az">Kingman</option>
        <option value="barstow, ca">Barstow</option>
        <option value="san bernardino, ca">San Bernardino</option>
        <option value="los angeles, ca">Los Angeles</option>
    </select>
</div>

<div class="container" id="map"></div>
<script>
    function initMap() {

        // Sättar kartans focus där du är
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                var pos = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };
                map.setCenter(pos);
            }, function () {
                handleLocationError(true, map.getCenter());
            });
        } else {
            // Browser doesn't support Geolocation
            handleLocationError(false, map.getCenter());
        }

        var directionsService = new google.maps.DirectionsService();
        var directionsRenderer = new google.maps.DirectionsRenderer();
        let markersArray = [];

        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 7,
            center: { lat: 41.85, lng: -87.65 }
        });
        directionsRenderer.setMap(map);

         map.addListener('click', function (e) {
                console.log(e);
                addMarker(e.latLng);
            });

        var onChangeHandler = function () {
            calculateAndDisplayRoute(directionsService, directionsRenderer);
        };
        document.getElementById('start').addEventListener('change', onChangeHandler);
        document.getElementById('end').addEventListener('change', onChangeHandler);
    }

    function calculateAndDisplayRoute(directionsService, directionsRenderer) {
        directionsService.route(
            {
                origin: { query: document.getElementById('start').value },
                destination: { query: document.getElementById('end').value },
                travelMode: 'DRIVING'
            },
            function (response, status) {
                if (status === 'OK') {
                    directionsRenderer.setDirections(response);
                } else {
                    window.alert('Directions request failed due to ' + status);
                }
            });
    }

    function addMarker(latLng) {
        let marker = new google.maps.Marker({
            map: map,
            position: latLng,
            draggable: true
        });
        //store the marker object drawn on map in global array
        markersArray.push(marker);
    }


</script>

<script async defer src="@Keys.GoogleApiKey()"></script>




